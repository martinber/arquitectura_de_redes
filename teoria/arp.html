

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>ARP &mdash; documentación de Arquitectura de Redes - </title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Índice"
              href="../genindex.html"/>
        <link rel="search" title="Búsqueda" href="../search.html"/>
    <link rel="top" title="documentación de Arquitectura de Redes - " href="../index.html"/>
        <link rel="up" title="Teoría" href="index.html"/>
        <link rel="next" title="IPv4" href="ipv4.html"/>
        <link rel="prev" title="Ethernet" href="ethernet.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Arquitectura de Redes
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Teoría</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html#principal">Principal</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="general.html">General</a></li>
<li class="toctree-l3"><a class="reference internal" href="ethernet.html">Ethernet</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">ARP</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#header">Header</a></li>
<li class="toctree-l4"><a class="reference internal" href="#funcionamiento">Funcionamiento</a></li>
<li class="toctree-l4"><a class="reference internal" href="#capturas">Capturas</a></li>
<li class="toctree-l4"><a class="reference internal" href="#arp-gratuitous">ARP gratuitous</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ipv4.html">IPv4</a></li>
<li class="toctree-l3"><a class="reference internal" href="icmpv4.html">ICMPv4</a></li>
<li class="toctree-l3"><a class="reference internal" href="nat.html">NAT</a></li>
<li class="toctree-l3"><a class="reference internal" href="dhcp.html">DHCP</a></li>
<li class="toctree-l3"><a class="reference internal" href="vlan.html">VLAN</a></li>
<li class="toctree-l3"><a class="reference internal" href="ipv6.html">IPv6</a></li>
<li class="toctree-l3"><a class="reference internal" href="icmpv6.html">ICMPv6</a></li>
<li class="toctree-l3"><a class="reference internal" href="tcp.html">TCP</a></li>
<li class="toctree-l3"><a class="reference internal" href="udp.html">UDP</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#wan-y-ruteo">WAN y ruteo</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#capa-aplicacion-y-otros">Capa aplicación y otros</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../practica/index.html">Práctica</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Arquitectura de Redes</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Teoría</a> &raquo;</li>
        
      <li>ARP</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/teoria/arp.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="arp">
<h1>ARP<a class="headerlink" href="#arp" title="Enlazar permanentemente con este título">¶</a></h1>
<p>Address Resolution Protocol.</p>
<ul class="simple">
<li>Va sobre Ethernet.</li>
<li>No debería ser de capa 3 porque no tiene ruteo, y no debería ser de capa 2
porque no es Ethernet. Así que no está bien definido.</li>
<li>Se usa para descubrir la MAC de algún host a partir de su IP.</li>
<li>Los demás hosts aprovechan a escuchar ARP de otros para aprender sus MAC,
aunque supongo que lo hacen solamente si el destino es Broadcast en Ethernet.</li>
</ul>
<div class="section" id="header">
<h2>Header<a class="headerlink" href="#header" title="Enlazar permanentemente con este título">¶</a></h2>
<ul class="simple">
<li>Hardware type (HTYPE) (2 bytes): Protocolo de enlace, siempre es Ethernet
(<code class="docutils literal"><span class="pre">0x0001</span></code>).</li>
<li>Protocol type (PTYPE) (2 bytes): Protocolo de red, siempre es IP (<code class="docutils literal"><span class="pre">0x0800</span></code>).</li>
<li>Hardware address length (HLEN) (1 byte): Largo de dirección MAC, siempre es 6.</li>
<li>Protocol address length (PLEN) (1 byte): Largo de dirección IP, siempre es 4.</li>
<li>Operation (OPER) (2 bytes):<ul>
<li>1: Request</li>
<li>2: Reply</li>
<li>3: Request RARP</li>
<li>4: Reply RARP</li>
</ul>
</li>
<li>Sender hardware address (SHA) (6 bytes): MAC del emisor.</li>
<li>Protocol hardware address (SPA) (4 bytes): IP del emisor.</li>
<li>Target hardware address (THA) (6 bytes): MAC del destino.</li>
<li>Target hardware address (TPA) (4 bytes): IP del destino.</li>
</ul>
</div>
<div class="section" id="funcionamiento">
<h2>Funcionamiento<a class="headerlink" href="#funcionamiento" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Por ejemplo si A quiere saber la MAC de B:</p>
<ul class="simple">
<li>Request:<ul>
<li>Ethernet:<ul>
<li>Source MAC: A.</li>
<li>Destination MAC: <code class="docutils literal"><span class="pre">FF:FF:FF:FF:FF:FF</span></code>.</li>
<li>Type: <code class="docutils literal"><span class="pre">0x0806</span></code> (ARP).</li>
</ul>
</li>
<li>ARP:<ul>
<li>Opcode: 1 (Request).</li>
<li>Sender MAC: A.</li>
<li>Target MAC: <code class="docutils literal"><span class="pre">00:00:00:00:00:00</span></code>.</li>
<li>Sender IP: A.</li>
<li>Target IP: B.</li>
</ul>
</li>
</ul>
</li>
<li>Reply:<ul>
<li>Ethernet:<ul>
<li>Source MAC: B.</li>
<li>Destination MAC: A.</li>
<li>Type: <code class="docutils literal"><span class="pre">0x0806</span></code> (ARP).</li>
</ul>
</li>
<li>ARP:<ul>
<li>Opcode: 2 (Reply).</li>
<li>Sender MAC: B.</li>
<li>Target MAC: A.</li>
<li>Sender IP: B.</li>
<li>Target IP: A.</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="capturas">
<h2>Capturas<a class="headerlink" href="#capturas" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Request:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>Frame 75: 42 bytes on wire (336 bits), 42 bytes captured (336 bits) on interface 0
Ethernet II, Src: LiteonTe_13:12:f4 (24:fd:52:13:12:f4),
    Dst: Broadcast (ff:ff:ff:ff:ff:ff)
  Destination: Broadcast (ff:ff:ff:ff:ff:ff)
  Source: LiteonTe_13:12:f4 (24:fd:52:13:12:f4)
  Type: ARP (0x0806)
Address Resolution Protocol (request)
  Hardware type: Ethernet (1)
  Protocol type: IPv4 (0x0800)
  Hardware size: 6
  Protocol size: 4
  Opcode: request (1)
  Sender MAC address: LiteonTe_13:12:f4 (24:fd:52:13:12:f4)
  Sender IP address: 192.168.0.102
  Target MAC address: 00:00:00_00:00:00 (00:00:00:00:00:00)
  Target IP address: 192.168.0.200
</pre></div>
</div>
<p>Reply:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>Frame 1480: 42 bytes on wire (336 bits), 42 bytes captured (336 bits) on interface 0
Ethernet II, Src: HonHaiPr_13:7f:55 (08:3e:8e:13:7f:55),
    Dst: Micro-St_9e:e5:e1 (d8:cb:8a:9e:e5:e1)
  Destination: Micro-St_9e:e5:e1 (d8:cb:8a:9e:e5:e1)
  Source: HonHaiPr_13:7f:55 (08:3e:8e:13:7f:55)
  Type: ARP (0x0806)
Address Resolution Protocol (reply)
  Hardware type: Ethernet (1)
  Protocol type: IPv4 (0x0800)
  Hardware size: 6
  Protocol size: 4
  Opcode: reply (2)
  Sender MAC address: HonHaiPr_13:7f:55 (08:3e:8e:13:7f:55)
  Sender IP address: 192.168.0.20
  Target MAC address: Micro-St_9e:e5:e1 (d8:cb:8a:9e:e5:e1)
  Target IP address: 192.168.0.120
</pre></div>
</div>
</div>
<div class="section" id="arp-gratuitous">
<h2>ARP gratuitous<a class="headerlink" href="#arp-gratuitous" title="Enlazar permanentemente con este título">¶</a></h2>
<p>A gratuitous ARP request is an AddressResolutionProtocol request packet where
the source and destination IP are both set to the IP of the machine issuing the
packet and the destination MAC is the broadcast address ff:ff:ff:ff:ff:ff.
Ordinarily, no reply packet will occur. A gratuitous ARP reply is a reply to
which no request has been made.</p>
<p>Para hacer ARP gratuitos:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>arping -A -c 100000 -I enp4s0 {mi IP}
</pre></div>
</div>
<p>Captura al usar ese comando:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>Frame 32: 60 bytes on wire (480 bits), 60 bytes captured (480 bits) on
    interface 0
Ethernet II, Src: Dell_17:2b:b2 (10:7d:1a:17:2b:b2), Dst: Broadcast
    (ff:ff:ff:ff:ff:ff)
  Destination: Broadcast (ff:ff:ff:ff:ff:ff)
  Source: Dell_17:2b:b2 (10:7d:1a:17:2b:b2)
  Type: ARP (0x0806)
  Padding: 000000000000000000000000000000000000
Address Resolution Protocol (reply/gratuitous ARP)
  Hardware type: Ethernet (1)
  Protocol type: IPv4 (0x0800)
  Hardware size: 6
  Protocol size: 4
  Opcode: reply (2)
  [Is gratuitous: True]
  Sender MAC address: Dell_17:2b:b2 (10:7d:1a:17:2b:b2)
  Sender IP address: 192.168.1.215
  Target MAC address: Dell_17:2b:b2 (10:7d:1a:17:2b:b2)
  Target IP address: 192.168.1.215
</pre></div>
</div>
<p>En la casa del nano capturé ARP gratuitous distintos, algunos reply y otros
request:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>Frame 4: 60 bytes on wire (480 bits), 60 bytes captured (480 bits) on
    interface 0
Ethernet II, Src: Zhejiang_ad:9f:5f (4c:11:bf:ad:9f:5f), Dst: Broadcast
    (ff:ff:ff:ff:ff:ff)
Address Resolution Protocol (request/gratuitous ARP)
  Hardware type: Ethernet (1)
  Protocol type: IPv4 (0x0800)
  Hardware size: 6
  Protocol size: 4
  Opcode: request (1)
  [Is gratuitous: True]
  Sender MAC address: Zhejiang_ad:9f:5f (4c:11:bf:ad:9f:5f)
  Sender IP address: 192.168.15.50
  Target MAC address: 00:00:00_00:00:00 (00:00:00:00:00:00)
  Target IP address: 192.168.15.50

Frame 11: 60 bytes on wire (480 bits), 60 bytes captured (480 bits) on
    interface 0
Ethernet II, Src: Zhejiang_ad:9f:5f (4c:11:bf:ad:9f:5f), Dst: Broadcast
    (ff:ff:ff:ff:ff:ff)
Address Resolution Protocol (reply/gratuitous ARP)
  Hardware type: Ethernet (1)
  Protocol type: IPv4 (0x0800)
  Hardware size: 6
  Protocol size: 4
  Opcode: reply (2)
  [Is gratuitous: True]
  Sender MAC address: Zhejiang_ad:9f:5f (4c:11:bf:ad:9f:5f)
  Sender IP address: 192.168.15.50
  Target MAC address: 00:00:00_00:00:00 (00:00:00:00:00:00)
  Target IP address: 192.168.15.50
</pre></div>
</div>
<p>Hay algunos ARP gratuitous en donde es una request con la target MAC vacía con
ceros, pidiendole al que tenga la misma IP que yo que me responda con su MAC.</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ipv4.html" class="btn btn-neutral float-right" title="IPv4" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="ethernet.html" class="btn btn-neutral" title="Ethernet" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018-2019, Martín Bernardi.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/translations.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>