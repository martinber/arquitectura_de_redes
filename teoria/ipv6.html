

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>IPv6 &mdash; documentación de Arquitectura de Redes - </title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Índice"
              href="../genindex.html"/>
        <link rel="search" title="Búsqueda" href="../search.html"/>
    <link rel="top" title="documentación de Arquitectura de Redes - " href="../index.html"/>
        <link rel="up" title="Teoría" href="index.html"/>
        <link rel="next" title="ICMPv6" href="icmpv6.html"/>
        <link rel="prev" title="VLAN" href="vlan.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Arquitectura de Redes
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Teoría</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html#principal">Principal</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="general.html">General</a></li>
<li class="toctree-l3"><a class="reference internal" href="ethernet.html">Ethernet</a></li>
<li class="toctree-l3"><a class="reference internal" href="arp.html">ARP</a></li>
<li class="toctree-l3"><a class="reference internal" href="ipv4.html">IPv4</a></li>
<li class="toctree-l3"><a class="reference internal" href="icmpv4.html">ICMPv4</a></li>
<li class="toctree-l3"><a class="reference internal" href="nat.html">NAT</a></li>
<li class="toctree-l3"><a class="reference internal" href="dhcp.html">DHCP</a></li>
<li class="toctree-l3"><a class="reference internal" href="vlan.html">VLAN</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">IPv6</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#header">Header</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tipos-de-direcciones">Tipos de direcciones</a></li>
<li class="toctree-l4"><a class="reference internal" href="#direcciones-de-cada-host">Direcciones de cada host</a></li>
<li class="toctree-l4"><a class="reference internal" href="#slaac">SLAAC</a></li>
<li class="toctree-l4"><a class="reference internal" href="#migracion-desde-ipv4">Migración desde IPv4</a></li>
<li class="toctree-l4"><a class="reference internal" href="#fragmentacion">Fragmentación</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="icmpv6.html">ICMPv6</a></li>
<li class="toctree-l3"><a class="reference internal" href="tcp.html">TCP</a></li>
<li class="toctree-l3"><a class="reference internal" href="udp.html">UDP</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#wan-y-ruteo">WAN y ruteo</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#capa-aplicacion-y-otros">Capa aplicación y otros</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../practica/index.html">Práctica</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Arquitectura de Redes</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Teoría</a> &raquo;</li>
        
      <li>IPv6</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/teoria/ipv6.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="ipv6">
<h1>IPv6<a class="headerlink" href="#ipv6" title="Enlazar permanentemente con este título">¶</a></h1>
<p>Internet Protocol version 6.</p>
<ul class="simple">
<li>Tiene direcciones de 128 bits.</li>
<li>Hay un encabezado obligatorio de tamaño fijo y luego encabezados opcionales.</li>
</ul>
<div class="section" id="header">
<h2>Header<a class="headerlink" href="#header" title="Enlazar permanentemente con este título">¶</a></h2>
<ul class="simple">
<li>Version (4 bits): Siempre es 6.</li>
<li>Traffic Class (8 bits): Incluye los campos DS y ECN.<ul>
<li>Differentiated Services (DS) (6 bits): Tipo de servicio, para QoS pero no
se usa.</li>
<li>Explicit Congestion Notification (ECN) (2 bits): Se usa poco, indica que hay
congestión en la red.</li>
</ul>
</li>
<li>Flow Label (20 bits): Para QoS.</li>
<li>Payload Length (16 bits): Largo de los datos, incluyendo los encabezados de
extensión.</li>
<li>Next Header (8 bits): Tipo del próximo header, es el número de protocolo
encapsulado, en el caso que se usen encabezados de extensión lleva el código
que lo identifica.</li>
<li>Hop Limit (8 bits): Este valor disminuye salto a salto y el paquete es
descartado si llega a cero.</li>
<li>Source address (128 bits): IP de origen.</li>
<li>Destination address (128 bits): IP de destino.</li>
</ul>
</div>
<div class="section" id="tipos-de-direcciones">
<h2>Tipos de direcciones<a class="headerlink" href="#tipos-de-direcciones" title="Enlazar permanentemente con este título">¶</a></h2>
<ul class="simple">
<li>Según destino:<ul>
<li>Unicast: Se entrega a una única interfaz.</li>
<li>Multicast: Se entrega a múltiples interfaces.</li>
<li>Anycast: Se entrega a cualquiera de las interfaces del conjunto.</li>
<li>No existe broadcast.</li>
</ul>
</li>
<li>Según rango:<ul>
<li>Link-Local: <code class="docutils literal"><span class="pre">fe80::/16</span></code>.</li>
<li>Globalmente ruteable: <code class="docutils literal"><span class="pre">2000::/3</span></code>.</li>
<li>Global: <code class="docutils literal"><span class="pre">2001::/16</span></code>.</li>
<li>Documentación: <code class="docutils literal"><span class="pre">2001:db8::/32</span></code>.</li>
<li>Teredo: <code class="docutils literal"><span class="pre">2001:0::/32</span></code>.</li>
<li>6to4: <code class="docutils literal"><span class="pre">2002::/16</span></code>.</li>
<li>Mapeada IPv4: <code class="docutils literal"><span class="pre">::ffff:xxxx/112</span></code>.</li>
<li>Compatible IPv4: <code class="docutils literal"><span class="pre">::xxxx/112</span></code> (Obsoleto).</li>
</ul>
</li>
<li>Direcciones especiales:<ul>
<li>Loopback: <code class="docutils literal"><span class="pre">::1/128</span></code>.</li>
<li>No especificada: <code class="docutils literal"><span class="pre">::/128</span></code>.</li>
</ul>
</li>
</ul>
<p>En las multicast se definen dominios por donde los paquetes se propagan:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">FF00::/16</span></code>: Reservado.</li>
<li><code class="docutils literal"><span class="pre">FF01::/16</span></code>: Interface-Local, abarca sólo una interfaz, sirve para loopback.</li>
<li><code class="docutils literal"><span class="pre">FF02::/16</span></code>: Link-Local, abarca sólo un enlace de red, o un dominio de
broadcast.</li>
<li><code class="docutils literal"><span class="pre">FF03::/16</span></code>: Realm-Local, definido automáticamente, más grande que
Link-Local pero mas chico que Admin-Local.</li>
<li><code class="docutils literal"><span class="pre">FF04::/16</span></code>: Admin-Local, se configura administrativamente.</li>
<li><code class="docutils literal"><span class="pre">FF05::/16</span></code>: Site-Local, se configura administrativamente, pensado para un
sitio perteneciente a una organización.</li>
<li><code class="docutils literal"><span class="pre">FF08::/16</span></code>: Organization-Local, se configura administrativamente, pensado
para todos los sitios de una organización.</li>
<li><code class="docutils literal"><span class="pre">FF0E::/16</span></code>: Global.</li>
<li><code class="docutils literal"><span class="pre">FF0F::/16</span></code>: Reservado.</li>
</ul>
</div>
<div class="section" id="direcciones-de-cada-host">
<h2>Direcciones de cada host<a class="headerlink" href="#direcciones-de-cada-host" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Según RFC 4291. Un host debe identificarse con las siguientes direcciones IPv6:</p>
<ul class="simple">
<li>Su dirección Link-Local para cada interfaz</li>
<li>Direcciones unicast o anycast configuradas manualmente o automáticamente.</li>
<li>Loopback (<code class="docutils literal"><span class="pre">::1</span></code>).</li>
<li>Multicast All-Nodes:<ul>
<li><code class="docutils literal"><span class="pre">FF01::1</span></code>: Todos los nodos IPv6 en Interface-Local.</li>
<li><code class="docutils literal"><span class="pre">FF02::1</span></code>: Todos los nodos IPv6 en Link-Local.</li>
</ul>
</li>
<li>Multicast Solicited-Node para cada IPv6 unicast o anycast:<ul>
<li><code class="docutils literal"><span class="pre">FF02::1:FFXX:XXXX</span></code>: Los últimos 24 bits provienen de los últimos 24 bits
de la dirección unicast o anycast. Se usa por ejemplo para los Neighbor
Solicitation ya que permite comunicarse mediante una sola ip Link-Layer a un
nodo que podría tener más de una IP debido a que podría tener múltiples
prefijos.</li>
</ul>
</li>
<li>Multicast de todos los otros grupos al que el nodo pertenezca.</li>
</ul>
<p>Los routers además deben reconocer:</p>
<ul class="simple">
<li>Multicast All-Nodes:<ul>
<li><code class="docutils literal"><span class="pre">FF01::2</span></code>: Todos los routers IPv6 en Interface-Local.</li>
<li><code class="docutils literal"><span class="pre">FF02::2</span></code>: Todos los routers IPv6 en Link-Local.</li>
<li><code class="docutils literal"><span class="pre">FF05::2</span></code>: Todos los routers IPv6 en Site-Local.</li>
</ul>
</li>
<li>Anycast Subnet-Router, lleva a cualquier router de una determinada red.
Consiste del número IPv6 de red, con todos los otros bits en cero.</li>
</ul>
</div>
<div class="section" id="slaac">
<h2>SLAAC<a class="headerlink" href="#slaac" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Stateless Address Autoconfiguration.</p>
<ul class="simple">
<li>Permite a los hosts obtener direcciones IPv6 ruteables por medio de Router
Advertisement y Router Solicitation (pertenecientes a ICMPv6).</li>
<li>Si es necesario, se puede usar DHCPv6 en lugar de SLAAC.</li>
<li>Primero el host obtiene su dirección link-local y envía un Router
Solicitation. Luego el router responde con un Router Advertisement, indicando
el prefijo de red que usará el host.</li>
<li>El Router Solicitation es enviado a la multicast <code class="docutils literal"><span class="pre">FF02::2</span></code>, que representa
a todos los routers en link-local.</li>
<li>El Router Advertisement es enviado a la multicast <code class="docutils literal"><span class="pre">FF02::1</span></code>, que representa
a todos los nodos en link-local.</li>
</ul>
<p>Hay varios métodos para obtener la parte de host (64 bits), que va a ser usada
para generar la link-local y las demás direcciones IPv6.</p>
<ul class="simple">
<li>EUI-64 modificado: Se toma la dirección MAC, se agrega <code class="docutils literal"><span class="pre">FFFE</span></code> al medio y se
pone el séptimo bit en uno.</li>
<li>Direcciones aleatorias: Un problema de usar la MAC en la dirección es que
permite seguir a un host a través de redes, por lo tanto se puede usar una
dirección de host aleatoria que dure horas o días.</li>
<li>Stable privacy: Son aleatorias al cambiar de red pero fijas en una misma red,
se generan a partir de la parte de red, interfaz, etc.</li>
</ul>
</div>
<div class="section" id="migracion-desde-ipv4">
<h2>Migración desde IPv4<a class="headerlink" href="#migracion-desde-ipv4" title="Enlazar permanentemente con este título">¶</a></h2>
<p>El problema más común es que el núcleo de internet es IPv4, entonces hay que
buscar la forma de enviar tráfico IPv6 a través de una red IPv4. Las soluciones
que hay son:</p>
<ul class="simple">
<li>Túneles manuales: Se deben configurar manualmente en ambos extremos.</li>
<li>Túneles automáticos: Por ejemplo <a class="reference internal" href="6to4.html"><span class="doc">6to4</span></a>.</li>
<li>Traslación: Es una extensión de NAT para cambiar headers y direcciones.</li>
</ul>
</div>
<div class="section" id="fragmentacion">
<h2>Fragmentación<a class="headerlink" href="#fragmentacion" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Se usa un header opcional para la fragmentación.</p>
<p>A diferencia de IPv4, sólo se puede hacer en los extremos. Los hosts intentan
enviar los mensajes con un determinado tamaño, si se devuelve un <em>ICMP packet
too big</em> se vuelve a intentar con el MTU dado en ese mensaje.</p>
<p>Enviando ping con un tamaño de 4000 usando <code class="docutils literal"><span class="pre">ping6</span> <span class="pre">fe80::2273:55ff:fe06:2451</span> <span class="pre">-I</span>
<span class="pre">wlan0</span> <span class="pre">-s</span> <span class="pre">4000</span></code>:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>fe80::39af:... fe80::2273:... IPv6     IPv6 fragment (off=0 more=y ident=0x79a0649e nxt=58)
fe80::39af:... fe80::2273:... IPv6     IPv6 fragment (off=1448 more=y ident=0x79a0649e nxt=58)
fe80::39af:... fe80::2273:... ICMPv6   Echo (ping) request id=0x3eeb, seq=4, hop limit=64 (reply in 50)
</pre></div>
</div>
<p>Se partió en 3 fragmentos, header de cada fragmento:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>Internet Protocol Version 6, Src: fe80::39af:14fa:830b:c073, Dst: fe80::2273:55ff:fe06:2451
    0110 .... = Version: 6
    .... 0000 0000 .... .... .... .... .... = Traffic class: 0x00 (DSCP: CS0, ECN: Not-ECT)
    .... .... .... 1000 0010 0011 1011 0111 = Flow label: 0x823b7
    Payload length: 1456
    Next header: Fragment Header for IPv6 (44)
    Hop limit: 64
    Source: fe80::39af:14fa:830b:c073
    Destination: fe80::2273:55ff:fe06:2451
    [Destination SA MAC: ArrisGro_06:24:51 (20:73:55:06:24:51)]
    [Source GeoIP: Unknown]
    [Destination GeoIP: Unknown]
    Fragment Header for IPv6
        Next header: ICMPv6 (58)
        Reserved octet: 0x00
        0000 0000 0000 0... = Offset: 0 (0 bytes)
        .... .... .... .00. = Reserved bits: 0
        .... .... .... ...1 = More Fragments: Yes
        Identification: 0x79a0649e
    Reassembled IPv6 in frame: 47

Frame 46: 1510 bytes on wire (12080 bits), 1510 bytes captured (12080 bits) on interface 0
Ethernet II, Src: HonHaiPr_13:7f:55 (08:3e:8e:13:7f:55), Dst: ArrisGro_06:24:51 (20:73:55:06:24:51)
Internet Protocol Version 6, Src: fe80::39af:14fa:830b:c073, Dst: fe80::2273:55ff:fe06:2451
    0110 .... = Version: 6
    .... 0000 0000 .... .... .... .... .... = Traffic class: 0x00 (DSCP: CS0, ECN: Not-ECT)
    .... .... .... 1000 0010 0011 1011 0111 = Flow label: 0x823b7
    Payload length: 1456
    Next header: Fragment Header for IPv6 (44)
    Hop limit: 64
    Source: fe80::39af:14fa:830b:c073
    Destination: fe80::2273:55ff:fe06:2451
    [Destination SA MAC: ArrisGro_06:24:51 (20:73:55:06:24:51)]
    [Source GeoIP: Unknown]
    [Destination GeoIP: Unknown]
    Fragment Header for IPv6
        Next header: ICMPv6 (58)
        Reserved octet: 0x00
        0000 0101 1010 1... = Offset: 181 (1448 bytes)
        .... .... .... .00. = Reserved bits: 0
        .... .... .... ...1 = More Fragments: Yes
        Identification: 0x79a0649e
    Reassembled IPv6 in frame: 47

Frame 47: 1174 bytes on wire (9392 bits), 1174 bytes captured (9392 bits) on interface 0
Ethernet II, Src: HonHaiPr_13:7f:55 (08:3e:8e:13:7f:55), Dst: ArrisGro_06:24:51 (20:73:55:06:24:51)
Internet Protocol Version 6, Src: fe80::39af:14fa:830b:c073, Dst: fe80::2273:55ff:fe06:2451
    0110 .... = Version: 6
    .... 0000 0000 .... .... .... .... .... = Traffic class: 0x00 (DSCP: CS0, ECN: Not-ECT)
    .... .... .... 1000 0010 0011 1011 0111 = Flow label: 0x823b7
    Payload length: 1120
    Next header: Fragment Header for IPv6 (44)
    Hop limit: 64
    Source: fe80::39af:14fa:830b:c073
    Destination: fe80::2273:55ff:fe06:2451
    [Destination SA MAC: ArrisGro_06:24:51 (20:73:55:06:24:51)]
    [Source GeoIP: Unknown]
    [Destination GeoIP: Unknown]
    Fragment Header for IPv6
        Next header: ICMPv6 (58)
        Reserved octet: 0x00
        0000 1011 0101 0... = Offset: 362 (2896 bytes)
        .... .... .... .00. = Reserved bits: 0
        .... .... .... ...0 = More Fragments: No
        Identification: 0x79a0649e
</pre></div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="icmpv6.html" class="btn btn-neutral float-right" title="ICMPv6" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="vlan.html" class="btn btn-neutral" title="VLAN" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018-2019, Martín Bernardi.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/translations.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>